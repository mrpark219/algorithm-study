# 157339 - 특정 기간동안 대여 가능한 자동차들의 대여비용 구하기

```mysql
SELECT
    CAR.CAR_ID AS CAR_ID,
    CAR.CAR_TYPE AS CAR_TYPE,
    FLOOR(CAR.DAILY_FEE * 30 * (100 - PLAN.DISCOUNT_RATE) / 100) AS FEE
FROM
    CAR_RENTAL_COMPANY_CAR AS CAR
        INNER JOIN CAR_RENTAL_COMPANY_DISCOUNT_PLAN AS PLAN
                   ON CAR.CAR_TYPE = PLAN.CAR_TYPE AND PLAN.DURATION_TYPE = '30일 이상'
WHERE
      CAR.CAR_TYPE IN ('세단', 'SUV')
  AND CAR.CAR_ID NOT IN (SELECT CAR_ID
                         FROM
                             CAR_RENTAL_COMPANY_RENTAL_HISTORY
                         WHERE
                               START_DATE <= '2022-11-30'
                           AND END_DATE >= '2022-11-01')
  AND CAR.DAILY_FEE * 30 * (100 - PLAN.DISCOUNT_RATE) / 100 BETWEEN 500000 AND 2000000
ORDER BY
    FEE DESC, CAR.CAR_TYPE ASC, CAR.CAR_ID DESC;
```

# 131117 - 5월 식품들의 총매출 조회하기

```mysql
SELECT
    FP.PRODUCT_ID AS PRODUCT_ID,
    FP.PRODUCT_NAME AS PRODUCT_NAME,
    SUM(FP.PRICE * FO.AMOUNT) AS 'TOTAL_SALES'
FROM
    FOOD_PRODUCT AS FP
        LEFT JOIN FOOD_ORDER AS FO ON FP.PRODUCT_ID = FO.PRODUCT_ID
WHERE
    FO.PRODUCE_DATE BETWEEN '2022-05-01' AND '2022-05-31'
GROUP BY
    FP.PRODUCT_ID
ORDER BY
    SUM(FP.PRICE * FO.AMOUNT) DESC, PRODUCT_ID ASC
```

# 133027 - 주문량이 많은 아이스크림들 조회하기

```mysql
SELECT
    FH.FLAVOR
FROM
    FIRST_HALF FH
        INNER JOIN JULY ON FH.FLAVOR = JULY.FLAVOR
GROUP BY
    FH.FLAVOR
ORDER BY
    SUM(FH.TOTAL_ORDER + JULY.TOTAL_ORDER) DESC
LIMIT 3;
```

# 59042 - 없어진 기록 찾기

```mysql
-- 코드를 입력하세요
SELECT
    AO.ANIMAL_ID AS ANIMAL_ID,
    AO.NAME AS NAME
FROM
    ANIMAL_OUTS AS AO
        LEFT JOIN ANIMAL_INS AS AI ON AO.ANIMAL_ID = AI.ANIMAL_ID
WHERE
    AI.ANIMAL_ID IS NULL
ORDER BY
    AO.ANIMAL_ID
```

# 131124 - 그룹별 조건에 맞는 식당 목록 출력하기

```mysql
SELECT
    MP.MEMBER_NAME AS MEMBER_NAME,
    RR.REVIEW_TEXT AS REVIEW_TEXT,
    DATE_FORMAT(RR.REVIEW_DATE, '%Y-%m-%d') AS REVIEW_DATE
FROM
    MEMBER_PROFILE MP
        LEFT JOIN REST_REVIEW RR ON MP.MEMBER_ID = RR.MEMBER_ID
WHERE
    MP.MEMBER_ID =
    (SELECT MEMBER_ID
     FROM
         REST_REVIEW
     GROUP BY MEMBER_ID
     ORDER BY COUNT(MEMBER_ID) DESC
     LIMIT 1)
ORDER BY
    RR.REVIEW_DATE ASC, RR.REVIEW_TEXT ASC
```

# 276035 - FrontEnd 개발자 찾기

```mysql
SELECT ID, EMAIL, FIRST_NAME, LAST_NAME
FROM
    DEVELOPERS
WHERE
    (SELECT 1 <= COUNT(*)
     FROM
         SKILLCODES
     WHERE
           CATEGORY = 'Front End'
       AND SKILL_CODE & CODE)
ORDER BY
    ID ASC
```

# 131534 - 상품을 구매한 회원 비율 구하기

```mysql
SELECT
    YEAR(SALES_DATE) AS YEAR, MONTH(SALES_DATE) AS MONTH, COUNT(DISTINCT OS.USER_ID) AS PUCHASED_USERS,
    ROUND(
            COUNT(DISTINCT OS.USER_ID) /
            (SELECT COUNT(*)
             FROM
                 USER_INFO
             WHERE
                 YEAR(JOINED) = 2021), 1) AS PUCHASED_RATIO
FROM
    USER_INFO AS UI
        INNER JOIN ONLINE_SALE AS OS ON UI.USER_ID = OS.USER_ID
WHERE
    YEAR(UI.JOINED) = 2021
GROUP BY
    YEAR, MONTH
ORDER BY
    YEAR, MONTH
```

# 59043 - 있었는데요 없었습니다

```mysql
SELECT
    AI.ANIMAL_ID AS ANIMAL_ID, AI.NAME AS `NAME`
FROM
    ANIMAL_INS AS AI
        LEFT JOIN ANIMAL_OUTS AS AO ON AI.ANIMAL_ID = AO.ANIMAL_ID
WHERE
    AI.DATETIME > AO.DATETIME
ORDER BY
    AI.DATETIME
```

# 144854 - 조건에 맞는 도서와 저자 리스트 출력하기

```mysql
SELECT
    BOOK.BOOK_ID AS BOOK_ID, AUTHOR.AUTHOR_NAME AS AUTHOR_NAME,
    DATE_FORMAT(BOOK.PUBLISHED_DATE, '%Y-%m-%d') AS PUBLISHED_DATE
FROM
    BOOK
        JOIN AUTHOR ON BOOK.AUTHOR_ID = AUTHOR.AUTHOR_ID
WHERE
    BOOK.CATEGORY = '경제'
ORDER BY
    BOOK.PUBLISHED_DATE
```