# 157339 - 특정 기간동안 대여 가능한 자동차들의 대여비용 구하기

```mysql
SELECT
    CAR.CAR_ID AS CAR_ID,
    CAR.CAR_TYPE AS CAR_TYPE,
    FLOOR(CAR.DAILY_FEE * 30 * (100 - PLAN.DISCOUNT_RATE) / 100) AS FEE
FROM
    CAR_RENTAL_COMPANY_CAR AS CAR
        INNER JOIN CAR_RENTAL_COMPANY_DISCOUNT_PLAN AS PLAN
                   ON CAR.CAR_TYPE = PLAN.CAR_TYPE AND PLAN.DURATION_TYPE = '30일 이상'
WHERE
      CAR.CAR_TYPE IN ('세단', 'SUV')
  AND CAR.CAR_ID NOT IN (SELECT CAR_ID
                         FROM
                             CAR_RENTAL_COMPANY_RENTAL_HISTORY
                         WHERE
                               START_DATE <= '2022-11-30'
                           AND END_DATE >= '2022-11-01')
  AND CAR.DAILY_FEE * 30 * (100 - PLAN.DISCOUNT_RATE) / 100 BETWEEN 500000 AND 2000000
ORDER BY
    FEE DESC, CAR.CAR_TYPE ASC, CAR.CAR_ID DESC;
```

# 131117 - 5월 식품들의 총매출 조회하기

```mysql
SELECT
    FP.PRODUCT_ID AS PRODUCT_ID,
    FP.PRODUCT_NAME AS PRODUCT_NAME,
    SUM(FP.PRICE * FO.AMOUNT) AS 'TOTAL_SALES'
FROM
    FOOD_PRODUCT AS FP
        LEFT JOIN FOOD_ORDER AS FO ON FP.PRODUCT_ID = FO.PRODUCT_ID
WHERE
    FO.PRODUCE_DATE BETWEEN '2022-05-01' AND '2022-05-31'
GROUP BY
    FP.PRODUCT_ID
ORDER BY
    SUM(FP.PRICE * FO.AMOUNT) DESC, PRODUCT_ID ASC
```

# 133027 - 주문량이 많은 아이스크림들 조회하기

```mysql
SELECT
    FH.FLAVOR
FROM
    FIRST_HALF FH
        INNER JOIN JULY ON FH.FLAVOR = JULY.FLAVOR
GROUP BY
    FH.FLAVOR
ORDER BY
    SUM(FH.TOTAL_ORDER + JULY.TOTAL_ORDER) DESC
LIMIT 3;
```

# 59042 - 없어진 기록 찾기

```mysql
-- 코드를 입력하세요
SELECT
    AO.ANIMAL_ID AS ANIMAL_ID,
    AO.NAME AS NAME
FROM
    ANIMAL_OUTS AS AO
        LEFT JOIN ANIMAL_INS AS AI ON AO.ANIMAL_ID = AI.ANIMAL_ID
WHERE
    AI.ANIMAL_ID IS NULL
ORDER BY
    AO.ANIMAL_ID
```